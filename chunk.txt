const user_details=async(req,res)=>{
    try{
       let data=await user.find()
    //    console.log(data)
       chunkData=chunk(data,2000)
       console.log(chunkData)
       for (const chunk of chunkData) {
        await usersDetails.insertMany(chunk);
      }
       res.send("send")
    }catch(err){console.log(err);}
}

for(let i=0;i<index ;i++){
        const result = usersDetails.insertMany(chunkData[i])
    }


                const arr=chunkData;
                const newArr=arr.map(myFunction);

                console.log(newArr)
                function myFunction(chunkData){
                    return chunkData
                }
                const result=await usersDetails.bulkWrite([{insertOne:{"document":{newArr}}}])





  const myFunc=(data)=>{
                    const details={
                        name:data.name,
                        email:data.email,
                        phoneNo:data.phoneNo
                    }
                    return {insertOne:{document:details}}
                }
                const arr=chunkData[i]
             const newArr=  arr.map(myFunc)
                const result=await usersDetails.bulkWrite(newArr)
                insertData(chunkData, ++i)
            } else {
                // console.log(chunkData);
                res.send("send")
            }